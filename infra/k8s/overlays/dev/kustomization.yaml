apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: dev

resources:
- ../../base
- namespace.yaml
- ingress.yaml

# Override images with specific tags (updated by CI pipeline)
images:
- name: registry.digitalocean.com/ai-incident-assistant/backend
  newName: registry.digitalocean.com/ai-incident-assistant/backend
  newTag: 4b9a0c1cdc98639dd88bd8217d6c1d161c48f94d
- name: registry.digitalocean.com/ai-incident-assistant/frontend
  newName: registry.digitalocean.com/ai-incident-assistant/frontend
  newTag: 4b9a0c1cdc98639dd88bd8217d6c1d161c48f94d

# Environment-specific patches
patches:
- path: patch-replicas.yaml
  target:
    kind: Deployment

# Environment-specific config
configMapGenerator:
- literals:
  - NODE_ENV=development
  name: backend-config

labels:
- pairs:
    environment: dev
    managed-by: argocd
